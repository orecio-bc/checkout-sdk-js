{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///external \"tslib\"","webpack:///./src/cart/map-to-internal-cart.ts","webpack:///./src/promotion/map-to-discount-notifications.ts","webpack:///./src/billing/is-billing-address-like.ts","webpack:///./src/coupon/map-to-internal-coupon.ts","webpack:///./src/coupon/map-to-internal-gift-certificate.ts","webpack:///./src/common/utility/cache-key-maps.ts","webpack:///./src/common/utility/cache-key-resolver.ts","webpack:///./src/quote/map-to-internal-quote.ts","webpack:///./src/shipping/map-to-internal-shipping-options.ts","webpack:///./src/bundles/internal-mappers.ts","webpack:///external \"lodash\"","webpack:///./src/payment/payment-method-types.ts","webpack:///./src/address/map-to-internal-address.ts","webpack:///./src/cart/map-to-internal-line-items.ts","webpack:///./src/cart/map-gift-certificate-to-internal-line-item.ts","webpack:///external \"shallowequal\"","webpack:///./src/cart/map-to-internal-line-item.ts","webpack:///./src/shipping/map-to-internal-shipping-option.ts","webpack:///./src/common/utility/amount-transformer.ts","webpack:///./src/customer/map-to-internal-customer.ts","webpack:///./src/order/map-to-internal-order.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","require","mapToInternalCart","checkout","promotions","notifications","decimalPlaces","cart","currency","amountTransformer","id","items","lineItems","code","coupon","discountedAmount","coupons","sum","map","discount","amount","discountAmount","integerAmount","toInteger","discountNotifications","forEach","promotion","banners","banner","push","placeholders","discountType","message","messageHtml","text","giftCertificate","totalDiscountedAmount","giftCertificates","certificate","used","appliedGiftCertificates","shipping","shippingCostTotal","amountBeforeDiscount","shippingCostBeforeDiscount","integerAmountBeforeDiscount","required","physicalItems","lineItem","isShippingRequired","subtotal","storeCredit","customer","taxSubtotal","taxTotal","taxes","handling","handlingCostTotal","grandTotal","isBillingAddressLike","address","couponTypes","mapToInternalCoupon","displayName","indexOf","couponType","mapToInternalGiftCertificate","remainingBalance","remaining","balance","purchaseDate","isTerminalCacheKeyMap","options","_lastId","_map","maps","_usedMaps","this","_options","maxSize","isEqual","onExpire","getKey","result","_resolveMap","args","index","parentMap","cacheKey","usedCount","_generateMap","slice","_removeLeastUsedMap","getUsedCount","length","isMatched","mapIndex","unshift","splice","parent","terminalMap","recentlyUsedMap","pop","_removeMap","isRootCacheKeyMap","mapToInternalQuote","shippingAddress","consignment","consignments","orderComment","customerMessage","shippingOption","selectedShippingOption","undefined","billingAddress","mapToInternalShippingOptions","reduce","shippingOptions","availableShippingOptions","option","selectedOptionId","HOSTED","OFFLINE","mapToInternalAddress","addressId","firstName","lastName","company","addressLine1","address1","addressLine2","address2","city","province","stateOrProvince","provinceCode","stateOrProvinceCode","postCode","postalCode","country","countryCode","phone","customFields","mapToInternalLineItems","itemMap","idKey","keys","item","imageUrl","amountAfterDiscount","integerAmountAfterDiscount","integerUnitPrice","integerUnitPriceAfterDiscount","integerDiscount","quantity","sender","recipient","type","attributes","variantId","mapGiftCertificateToInternalLineItem","mapToInternalLineItemType","mapToInternalLineItem","extendedListPrice","extendedSalePrice","listPrice","salePrice","downloadsPageUrl","downloadPageUrl","brand","sku","categoryNames","productId","addedByPromotion","mapToInternalShippingOption","isSelected","description","price","cost","selected","isRecommended","transitTime","_decimalPlaces","Math","round","pow","mapToInternalCustomer","addresses","customerId","isGuest","email","fullName","join","customerGroupName","customerGroup","mapToInternalOrder","order","orderMeta","payments","orderId","customerCanBeCreated","payment","mapToInternalOrderPayment","baseAmount","token","orderToken","callbackUrl","providerId","detail","socialData","mapToInternalSocialDataList","status","hasDigitalItems","isDownloadable","isComplete","mapToStoreCredit","orderAmount","orderAmountAsInteger","mapToInternalPaymentStatus","isDefaultOrderPayment","step","helpText","instructions","returnUrl","socialDataObject","digitalItems","socialMedia","image","url","link","shareText","sharingLink","channelName","channel","channelCode"],"mappings":"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","file":"internal-mappers.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 198);\n","module.exports = require(\"tslib\");","import { keyBy, reduce, some } from 'lodash';\n\nimport { Checkout } from '../checkout';\nimport { AmountTransformer } from '../common/utility';\nimport { mapToInternalCoupon, mapToInternalGiftCertificate } from '../coupon';\nimport { mapToDiscountNotifications } from '../promotion';\n\nimport InternalCart from './internal-cart';\nimport mapToInternalLineItems from './map-to-internal-line-items';\n\n/**\n * @deprecated This mapper is only for internal use only. It is required during\n * the transition period as we are moving to adopt the new storefront API object\n * schema.\n */\nexport default function mapToInternalCart(checkout: Checkout): InternalCart {\n    const decimalPlaces = checkout.cart.currency.decimalPlaces;\n    const amountTransformer = new AmountTransformer(decimalPlaces);\n\n    return {\n        id: checkout.cart.id,\n        items: mapToInternalLineItems(checkout.cart.lineItems, decimalPlaces),\n        currency: checkout.cart.currency.code,\n        coupon: {\n            discountedAmount: reduce(checkout.cart.coupons, (sum, coupon) => {\n                return sum + coupon.discountedAmount;\n            }, 0),\n            coupons: checkout.cart.coupons.map(mapToInternalCoupon),\n        },\n        discount: {\n            amount: checkout.cart.discountAmount,\n            integerAmount: amountTransformer.toInteger(checkout.cart.discountAmount),\n        },\n        discountNotifications: mapToDiscountNotifications(checkout.promotions),\n        giftCertificate: {\n            totalDiscountedAmount: reduce(checkout.giftCertificates, (sum, certificate) => {\n                return sum + certificate.used;\n            }, 0),\n            appliedGiftCertificates: keyBy(checkout.giftCertificates.map(mapToInternalGiftCertificate), 'code'),\n        },\n        shipping: {\n            amount: checkout.shippingCostTotal,\n            integerAmount: amountTransformer.toInteger(checkout.shippingCostTotal),\n            amountBeforeDiscount: checkout.shippingCostBeforeDiscount,\n            integerAmountBeforeDiscount: amountTransformer.toInteger(checkout.shippingCostBeforeDiscount),\n            required: some(checkout.cart.lineItems.physicalItems, lineItem => lineItem.isShippingRequired),\n        },\n        subtotal: {\n            amount: checkout.subtotal,\n            integerAmount: amountTransformer.toInteger(checkout.subtotal),\n        },\n        storeCredit: {\n            amount: checkout.customer ? checkout.customer.storeCredit : 0,\n        },\n        taxSubtotal: {\n            amount: checkout.taxTotal,\n            integerAmount: amountTransformer.toInteger(checkout.taxTotal),\n        },\n        taxes: checkout.taxes,\n        taxTotal: {\n            amount: checkout.taxTotal,\n            integerAmount: amountTransformer.toInteger(checkout.taxTotal),\n        },\n        handling: {\n            amount: checkout.handlingCostTotal,\n            integerAmount: amountTransformer.toInteger(checkout.handlingCostTotal),\n        },\n        grandTotal: {\n            amount: checkout.grandTotal,\n            integerAmount: amountTransformer.toInteger(checkout.grandTotal),\n        },\n    };\n}\n","import { DiscountNotification } from '../discount';\n\nimport { Promotion } from '.';\n\nexport default function mapToDiscountNotifications(promotions?: Promotion[]): DiscountNotification[] {\n    const notifications: DiscountNotification[] = [];\n\n    (promotions || []).forEach(promotion => {\n        (promotion.banners || []).forEach(banner => {\n            notifications.push({\n                placeholders: [],\n                discountType: null,\n                message: '',\n                messageHtml: banner.text,\n            });\n        });\n    });\n\n    return notifications;\n}\n","import { Address } from '../address';\n\nimport BillingAddress from './billing-address';\n\nexport default function isBillingAddressLike(address: Address): address is BillingAddress {\n    const billingAddress = address as BillingAddress;\n\n    return typeof billingAddress.id !== 'undefined';\n}\n","import Coupon from './coupon';\nimport InternalCoupon from './internal-coupon';\n\nconst couponTypes = [\n    'per_item_discount',\n    'percentage_discount',\n    'per_total_discount',\n    'shipping_discount',\n    'free_shipping',\n];\n\n/**\n * @deprecated This mapper is only for internal use only. It is required during\n * the transition period as we are moving to adopt the new storefront API object\n * schema.\n */\nexport default function mapToInternalCoupon(coupon: Coupon): InternalCoupon {\n    return {\n        code: coupon.code,\n        discount: coupon.displayName,\n        discountType: couponTypes.indexOf(coupon.couponType),\n    };\n}\n","import GiftCertificate from './gift-certificate';\nimport InternalGiftCertificate from './internal-gift-certificate';\n\n/**\n * @deprecated This mapper is only for internal use only. It is required during\n * the transition period as we are moving to adopt the new storefront API object\n * schema.\n */\nexport default function mapToInternalGiftCertificate(giftCertificate: GiftCertificate): InternalGiftCertificate {\n    return {\n        code: giftCertificate.code,\n        discountedAmount: giftCertificate.used,\n        remainingBalance: giftCertificate.remaining,\n        giftCertificate: {\n            balance: giftCertificate.balance,\n            code: giftCertificate.code,\n            purchaseDate: giftCertificate.purchaseDate,\n        },\n    };\n}\n","export interface RootCacheKeyMap {\n    maps: ChildCacheKeyMap[];\n}\n\nexport interface IntermediateCacheKeyMap {\n    maps: ChildCacheKeyMap[];\n    parentMap: RootCacheKeyMap | IntermediateCacheKeyMap;\n    usedCount: number;\n    value: any;\n}\n\nexport interface TerminalCacheKeyMap extends IntermediateCacheKeyMap {\n    cacheKey: string;\n}\n\nexport type ChildCacheKeyMap = IntermediateCacheKeyMap | TerminalCacheKeyMap;\n\nexport function isTerminalCacheKeyMap(map: ChildCacheKeyMap): map is TerminalCacheKeyMap {\n    return map.hasOwnProperty('cacheKey');\n}\n\nexport function isRootCacheKeyMap(map: RootCacheKeyMap | ChildCacheKeyMap): map is RootCacheKeyMap {\n    return map.hasOwnProperty('parentMap');\n}\n","import { noop } from 'lodash';\nimport shallowEqual from 'shallowequal';\n\nimport { isRootCacheKeyMap, isTerminalCacheKeyMap, ChildCacheKeyMap, IntermediateCacheKeyMap, RootCacheKeyMap, TerminalCacheKeyMap } from './cache-key-maps';\n\nexport interface CacheKeyResolverOptions {\n    maxSize?: number;\n    onExpire?(key: string): void;\n    isEqual?(valueA: any, valueB: any): boolean;\n}\n\ninterface ResolveResult {\n    index: number;\n    parentMap: RootCacheKeyMap | IntermediateCacheKeyMap;\n    map?: TerminalCacheKeyMap;\n}\n\nexport default class CacheKeyResolver {\n    private _lastId = 0;\n    private _map: RootCacheKeyMap = { maps: [] };\n    private _usedMaps: TerminalCacheKeyMap[] = [];\n    private _options: Required<CacheKeyResolverOptions>;\n\n    constructor(options?: CacheKeyResolverOptions) {\n        this._options = {\n            maxSize: 0,\n            isEqual: shallowEqual,\n            onExpire: noop,\n            ...options,\n        };\n    }\n\n    getKey(...args: any[]): string {\n        const result = this._resolveMap(...args);\n        const { index, parentMap } = result;\n        let { map } = result;\n\n        if (map && map.cacheKey) {\n            map.usedCount++;\n        } else {\n            map = this._generateMap(parentMap, args.slice(index));\n        }\n\n        // Keep track of the least used map so we can remove it if the size of\n        // the stack exceeds the maximum size.\n        this._removeLeastUsedMap(map);\n\n        return map.cacheKey;\n    }\n\n    getUsedCount(...args: any[]): number {\n        const { map } = this._resolveMap(...args);\n\n        return map ? map.usedCount : 0;\n    }\n\n    private _resolveMap(...args: any[]): ResolveResult {\n        let index = 0;\n        let parentMap = this._map;\n\n        // Traverse the tree to find the linked list of maps that match the\n        // arguments of the call. Each intermediate or terminal map contains a\n        // value that could be used to match with the arguments. The last map in\n        // the list (the terminal) should contain a cache key. If it can does\n        // not exist, we will return a falsy value so that the caller could\n        // handle and generate a new cache key.\n        while (parentMap.maps.length) {\n            let isMatched = false;\n\n            for (let mapIndex = 0; mapIndex < parentMap.maps.length; mapIndex++) {\n                const map = parentMap.maps[mapIndex];\n\n                if (!this._options.isEqual(map.value, args[index])) {\n                    continue;\n                }\n\n                // Move the most recently used map to the top of the stack for\n                // quicker access\n                parentMap.maps.unshift(...parentMap.maps.splice(mapIndex, 1));\n\n                if ((args.length === 0 || index === args.length - 1) && isTerminalCacheKeyMap(map)) {\n                    return { index, map, parentMap };\n                }\n\n                isMatched = true;\n                parentMap = map;\n                index++;\n\n                break;\n            }\n\n            if (!isMatched) {\n                break;\n            }\n        }\n\n        return { index, parentMap };\n    }\n\n    private _generateMap(parent: RootCacheKeyMap | IntermediateCacheKeyMap, args: any[]): TerminalCacheKeyMap {\n        let index = 0;\n        let parentMap = parent;\n        let map: IntermediateCacheKeyMap;\n\n        do {\n            map = {\n                maps: [],\n                parentMap,\n                usedCount: 1,\n                value: args[index],\n            };\n\n            // Continue to build the tree of maps so that it could be resolved\n            // next time when the function is called with the same set of\n            // arguments.\n            parentMap.maps.unshift(map);\n\n            parentMap = map;\n            index++;\n        } while (index < args.length);\n\n        const terminalMap = map as TerminalCacheKeyMap;\n\n        terminalMap.cacheKey = `${++this._lastId}`;\n\n        return terminalMap;\n    }\n\n    private _removeLeastUsedMap(recentlyUsedMap: TerminalCacheKeyMap): void {\n        if (!this._options.maxSize) {\n            return;\n        }\n\n        const index = this._usedMaps.indexOf(recentlyUsedMap);\n\n        this._usedMaps.splice(\n            index === -1 ? 0 : index,\n            index === -1 ? 0 : 1,\n            recentlyUsedMap\n        );\n\n        if (this._usedMaps.length <= this._options.maxSize) {\n            return;\n        }\n\n        const map = this._usedMaps.pop();\n\n        if (!map) {\n            return;\n        }\n\n        this._removeMap(map);\n        this._options.onExpire(map.cacheKey);\n    }\n\n    private _removeMap(map: ChildCacheKeyMap): void {\n        if (!map.parentMap) {\n            return;\n        }\n\n        map.parentMap.maps.splice(map.parentMap.maps.indexOf(map), 1);\n\n        if (isRootCacheKeyMap(map.parentMap)) {\n            return;\n        }\n\n        this._removeMap(map.parentMap);\n    }\n}\n","import { mapToInternalAddress, Address, InternalAddress } from '../address';\nimport { Checkout } from '../checkout';\n\nimport InternalQuote from './internal-quote';\n\n/**\n * @deprecated This mapper is only for internal use only. It is required during\n * the transition period as we are moving to adopt the new storefront API object\n * schema.\n */\nexport default function mapToInternalQuote(checkout: Checkout, shippingAddress?: Address): InternalQuote {\n    const consignment = checkout.consignments && checkout.consignments[0];\n\n    return {\n        orderComment: checkout.customerMessage,\n        shippingOption: consignment && consignment.selectedShippingOption ? consignment.selectedShippingOption.id : undefined,\n        billingAddress: checkout.billingAddress ? mapToInternalAddress(checkout.billingAddress) : {} as InternalAddress,\n        shippingAddress: shippingAddress && mapToInternalAddress(shippingAddress, checkout.consignments),\n    };\n}\n","import Consignment from './consignment';\nimport { InternalShippingOptionList } from './internal-shipping-option';\nimport mapToInternalShippingOption from './map-to-internal-shipping-option';\n\n/**\n * @deprecated This mapper is only for internal use only. It is required during\n * the transition period as we are moving to adopt the new storefront API object\n * schema.\n */\nexport default function mapToInternalShippingOptions(consignments: Consignment[]): InternalShippingOptionList {\n    return consignments.reduce((result, consignment) => {\n        let shippingOptions;\n\n        if (consignment.availableShippingOptions && consignment.availableShippingOptions.length) {\n            shippingOptions = consignment.availableShippingOptions;\n        } else if (consignment.selectedShippingOption) {\n            shippingOptions = [consignment.selectedShippingOption];\n        }\n\n        return {\n            ...result,\n            [consignment.id]: (shippingOptions || []).map(option => {\n                const selectedOptionId = consignment.selectedShippingOption && consignment.selectedShippingOption.id;\n\n                return mapToInternalShippingOption(\n                    option,\n                    option.id === selectedOptionId\n                );\n            }),\n        };\n    }, {});\n}\n","/**\n * Please note that these mappers are for internal use only. DO NOT USE. They\n * can be removed or changed at any time.\n */\nexport { mapToInternalAddress } from '../address';\nexport { mapToInternalCart } from '../cart';\nexport { mapToInternalCoupon, mapToInternalGiftCertificate } from '../coupon';\nexport { mapToInternalCustomer } from '../customer';\nexport { mapToInternalLineItem, mapToInternalLineItems } from '../cart';\nexport { mapToInternalOrder } from '../order';\nexport { mapToInternalQuote } from '../quote';\nexport { mapToInternalShippingOption, mapToInternalShippingOptions } from '../shipping';\nexport { CacheKeyResolver } from '../common/utility';\n","module.exports = require(\"lodash\");","export const HOSTED = 'PAYMENT_TYPE_HOSTED';\nexport const OFFLINE = 'PAYMENT_TYPE_OFFLINE';\n","import { isBillingAddressLike, BillingAddress } from '../billing';\nimport { Consignment } from '../shipping';\n\nimport Address from './address';\nimport InternalAddress from './internal-address';\n\n/**\n * @deprecated This mapper is only for internal use only. It is required during\n * the transition period as we are moving to adopt the new storefront API object\n * schema.\n */\nexport default function mapToInternalAddress(\n    address: Address | BillingAddress,\n    consignments?: Consignment[]\n): InternalAddress<any> {\n    let addressId;\n\n    if (isBillingAddressLike(address)) {\n        addressId = address.id;\n    } else if (consignments && consignments.length) {\n        addressId = consignments[0].id;\n    }\n\n    return {\n        id: addressId,\n        firstName: address.firstName,\n        lastName: address.lastName,\n        company: address.company,\n        addressLine1: address.address1,\n        addressLine2: address.address2,\n        city: address.city,\n        province: address.stateOrProvince,\n        provinceCode: address.stateOrProvinceCode,\n        postCode: address.postalCode,\n        country: address.country,\n        countryCode: address.countryCode,\n        phone: address.phone,\n        customFields: address.customFields,\n    };\n}\n","import InternalLineItem from './internal-line-item';\nimport { LineItem } from './line-item';\nimport LineItemMap from './line-item-map';\nimport mapGiftCertificateToInternalLineItem from './map-gift-certificate-to-internal-line-item';\nimport mapToInternalLineItem from './map-to-internal-line-item';\n\n/**\n * @deprecated This mapper is only for internal use only. It is required during\n * the transition period as we are moving to adopt the new storefront API object\n * schema.\n */\nexport default function mapToInternalLineItems(\n    itemMap: LineItemMap,\n    decimalPlaces: number,\n    idKey: keyof LineItem = 'id'\n): InternalLineItem[] {\n    return (Object.keys(itemMap) as Array<keyof LineItemMap>)\n        .reduce((result, key) => [\n            ...result,\n            ...(itemMap[key] as LineItem[]).map((item: any) => {\n                if (key === 'giftCertificates') {\n                    return mapGiftCertificateToInternalLineItem(item, decimalPlaces);\n                }\n\n                return mapToInternalLineItem(\n                    item,\n                    mapToInternalLineItemType(key),\n                    decimalPlaces,\n                    idKey\n                );\n            }),\n        ], [] as InternalLineItem[]);\n}\n\nfunction mapToInternalLineItemType(type: string): string {\n    switch (type) {\n        case 'physicalItems':\n            return 'ItemPhysicalEntity';\n\n        case 'digitalItems':\n            return 'ItemDigitalEntity';\n\n        case 'giftCertificates':\n            return 'ItemGiftCertificateEntity';\n\n        default:\n            return '';\n    }\n}\n","import { AmountTransformer } from '../common/utility';\n\nimport InternalLineItem from './internal-line-item';\nimport { GiftCertificateItem } from './line-item';\n\nexport default function mapGiftCertificateToInternalLineItem(\n    item: GiftCertificateItem,\n    decimalPlaces: number\n): InternalLineItem {\n    const amountTransformer = new AmountTransformer(decimalPlaces);\n\n    return {\n        id: item.id,\n        imageUrl: '',\n        name: item.name,\n        amount: item.amount,\n        amountAfterDiscount: item.amount,\n        discount: 0,\n        integerAmount: amountTransformer.toInteger(item.amount),\n        integerAmountAfterDiscount: amountTransformer.toInteger(item.amount),\n        integerUnitPrice: amountTransformer.toInteger(item.amount),\n        integerUnitPriceAfterDiscount: amountTransformer.toInteger(item.amount),\n        integerDiscount: 0,\n        quantity: 1,\n        sender: item.sender,\n        recipient: item.recipient,\n        type: 'ItemGiftCertificateEntity',\n        attributes: [],\n        variantId: null,\n    };\n}\n","module.exports = require(\"shallowequal\");","import { AmountTransformer } from '../common/utility';\n\nimport InternalLineItem from './internal-line-item';\nimport { DigitalItem, LineItem } from './line-item';\n\n/**\n * @deprecated This mapper is only for internal use only. It is required during\n * the transition period as we are moving to adopt the new storefront API object\n * schema.\n */\nexport default function mapToInternalLineItem(\n    item: LineItem,\n    type: string,\n    decimalPlaces: number,\n    idKey: keyof LineItem = 'id'\n): InternalLineItem {\n    const amountTransformer = new AmountTransformer(decimalPlaces);\n\n    return {\n        id: (item[idKey] as string | number),\n        imageUrl: item.imageUrl,\n        amount: item.extendedListPrice,\n        amountAfterDiscount: item.extendedSalePrice,\n        discount: item.discountAmount,\n        integerAmount: amountTransformer.toInteger(item.extendedListPrice),\n        integerAmountAfterDiscount: amountTransformer.toInteger(item.extendedSalePrice),\n        integerDiscount: amountTransformer.toInteger(item.discountAmount),\n        integerUnitPrice: amountTransformer.toInteger(item.listPrice),\n        integerUnitPriceAfterDiscount: amountTransformer.toInteger(item.salePrice),\n        downloadsPageUrl: (item as DigitalItem).downloadPageUrl,\n        name: item.name,\n        quantity: item.quantity,\n        brand: item.brand,\n        sku: item.sku,\n        categoryNames: item.categoryNames,\n        variantId: item.variantId,\n        productId: item.productId,\n        attributes: (item.options || []).map(option => ({\n            name: option.name,\n            value: option.value,\n        })),\n        addedByPromotion: item.addedByPromotion,\n        type,\n    };\n}\n","import InternalShippingOption from './internal-shipping-option';\nimport ShippingOption from './shipping-option';\n\n/**\n * @deprecated This mapper is only for internal use only. It is required during\n * the transition period as we are moving to adopt the new storefront API object\n * schema.\n */\nexport default function mapToInternalShippingOption(option: ShippingOption, isSelected: boolean): InternalShippingOption {\n    return {\n        description: option.description,\n        module: option.type,\n        price: option.cost,\n        id: option.id,\n        selected: isSelected,\n        isRecommended: option.isRecommended,\n        imageUrl: option.imageUrl,\n        transitTime: option.transitTime,\n    };\n}\n","export default class AmountTransformer {\n    constructor(private _decimalPlaces: number) {}\n\n    toInteger(amount: number): number {\n        return Math.round(amount * Math.pow(10, this._decimalPlaces));\n    }\n}\n","import { mapToInternalAddress } from '../address';\nimport { BillingAddress } from '../billing';\n\nimport { Customer } from '.';\nimport InternalCustomer from './internal-customer';\n\n/**\n * @deprecated This mapper is only for internal use only. It is required during\n * the transition period as we are moving to adopt the new storefront API object\n * schema.\n */\nexport default function mapToInternalCustomer(customer: Customer, billingAddress: BillingAddress): InternalCustomer {\n    const firstName = customer.firstName || billingAddress.firstName || '';\n    const lastName = customer.lastName || billingAddress.lastName || '';\n\n    return {\n        addresses: (customer.addresses || []).map(address => mapToInternalAddress(address)),\n        customerId: customer.id,\n        isGuest: customer.isGuest,\n        storeCredit: customer.storeCredit,\n        email: customer.email || billingAddress.email || '',\n        firstName,\n        lastName,\n        name: customer.fullName || [firstName, lastName].join(' '),\n        customerGroupName: customer.customerGroup && customer.customerGroup.name,\n    };\n}\n","import { filter, find, keyBy, reduce } from 'lodash';\n\nimport { mapToInternalLineItems, LineItem } from '../cart';\nimport { Checkout } from '../checkout';\nimport { AmountTransformer } from '../common/utility';\nimport { mapToInternalCoupon } from '../coupon';\nimport { HOSTED } from '../payment';\n\nimport InternalOrder, { InternalGiftCertificateList, InternalIncompleteOrder, InternalOrderPayment, InternalSocialDataList } from './internal-order';\nimport Order, { GatewayOrderPayment, GiftCertificateOrderPayment, OrderPayment, OrderPayments } from './order';\nimport { OrderMetaState } from './order-state';\n\n/**\n * @deprecated This mapper is only for internal use only. It is required during\n * the transition period as we are moving to adopt the new storefront API object\n * schema.\n */\nexport default function mapToInternalOrder(order: Order, orderMeta: OrderMetaState = {}): InternalOrder {\n    const decimalPlaces = order.currency.decimalPlaces;\n    const amountTransformer = new AmountTransformer(decimalPlaces);\n\n    return {\n        id: order.orderId,\n        items: mapToInternalLineItems(order.lineItems, order.currency.decimalPlaces, 'productId'),\n        orderId: order.orderId,\n        currency: order.currency.code,\n        customerCanBeCreated: order.customerCanBeCreated,\n        payment: mapToInternalOrderPayment(order.payments, orderMeta.payment),\n        subtotal: {\n            amount: order.baseAmount,\n            integerAmount: amountTransformer.toInteger(order.baseAmount),\n        },\n        coupon: {\n            discountedAmount: reduce(order.coupons, (sum, coupon) => {\n                return sum + coupon.discountedAmount;\n            }, 0),\n            coupons: order.coupons.map(mapToInternalCoupon),\n        },\n        discount: {\n            amount: order.discountAmount,\n            integerAmount: amountTransformer.toInteger(order.discountAmount),\n        },\n        token: orderMeta.orderToken,\n        callbackUrl: orderMeta.callbackUrl,\n        discountNotifications: [],\n        giftCertificate: mapToGiftCertificates(order.payments),\n        socialData: mapToInternalSocialDataList(order),\n        status: order.status,\n        hasDigitalItems: order.hasDigitalItems,\n        isDownloadable: order.isDownloadable,\n        isComplete: order.isComplete,\n        shipping: {\n            amount: order.shippingCostTotal,\n            integerAmount: amountTransformer.toInteger(order.shippingCostTotal),\n            amountBeforeDiscount: order.shippingCostBeforeDiscount,\n            integerAmountBeforeDiscount: amountTransformer.toInteger(order.shippingCostBeforeDiscount),\n        },\n        storeCredit: {\n            amount: mapToStoreCredit(order.payments),\n        },\n        taxes: order.taxes,\n        taxTotal: {\n            amount: order.taxTotal,\n            integerAmount: amountTransformer.toInteger(order.taxTotal),\n        },\n        handling: {\n            amount: order.handlingCostTotal,\n            integerAmount: amountTransformer.toInteger(order.handlingCostTotal),\n        },\n        grandTotal: {\n            amount: order.orderAmount,\n            integerAmount: order.orderAmountAsInteger,\n        },\n    };\n}\n\nexport function mapToInternalIncompleteOrder(checkout: Checkout): InternalIncompleteOrder {\n    const payment = find(checkout.payments, { providerType: HOSTED });\n\n    return {\n        orderId: null,\n        isComplete: false,\n        payment: !payment ? {} : {\n            id: payment.providerId,\n            gateway: payment.gatewayId,\n            status: mapToInternalPaymentStatus(payment.detail.step),\n        },\n    };\n}\n\nfunction mapToInternalPaymentStatus(status: string): string {\n    return `PAYMENT_STATUS_${status}`;\n}\n\nfunction mapToStoreCredit(payments?: OrderPayments): number {\n    const item = find(payments, { providerId: 'storecredit' });\n\n    return item ? item.amount : 0;\n}\n\nfunction mapToGiftCertificates(payments?: OrderPayments): InternalGiftCertificateList {\n    const items = filter(payments, { providerId: 'giftcertificate' }) as GiftCertificateOrderPayment[];\n\n    return {\n        totalDiscountedAmount: reduce(items, (sum, item) => item.amount + sum, 0),\n        appliedGiftCertificates: keyBy(items.map(item => ({\n            code: item.detail.code,\n            discountedAmount: item.amount,\n            remainingBalance: item.detail.remaining,\n            giftCertificate: {\n                balance: item.amount + item.detail.remaining,\n                code: item.detail.code,\n                purchaseDate: '',\n            },\n        })), 'code'),\n    };\n}\n\nfunction mapToInternalOrderPayment(payments?: OrderPayments, payment: InternalOrderPayment = {}): InternalOrderPayment {\n    const item = find(payments, isDefaultOrderPayment) as GatewayOrderPayment;\n\n    if (!item) {\n        return {};\n    }\n\n    return {\n        id: item.providerId,\n        status: mapToInternalPaymentStatus(item.detail.step),\n        helpText: item.detail.instructions,\n        returnUrl: payment.returnUrl,\n    };\n}\n\nfunction isDefaultOrderPayment(payment: OrderPayment): payment is GatewayOrderPayment {\n    return payment.providerId !== 'giftcertificate' && payment.providerId !== 'storecredit';\n}\n\nfunction mapToInternalSocialDataList(order: Order): { [itemId: string]: InternalSocialDataList } | undefined {\n    const socialDataObject: { [itemId: string]: InternalSocialDataList } = {};\n    const items = [\n        ...order.lineItems.physicalItems,\n        ...order.lineItems.digitalItems,\n    ];\n\n    items.forEach(item => {\n        socialDataObject[item.id] = mapToInternalSocialData(item);\n    });\n\n    return socialDataObject;\n}\n\nfunction mapToInternalSocialData(lineItem: LineItem): InternalSocialDataList {\n    const codes = ['fb', 'tw', 'gp'];\n\n    return codes.reduce((socialData, code) => {\n        const item = lineItem.socialMedia && find(lineItem.socialMedia, item => item.code === code);\n\n        if (!item) {\n            return socialData;\n        }\n\n        socialData[code] = {\n            name: lineItem.name,\n            description: lineItem.name,\n            image: lineItem.imageUrl,\n            url: item.link,\n            shareText: item.text,\n            sharingLink: item.link,\n            channelName: item.channel,\n            channelCode: item.code,\n        };\n\n        return socialData;\n    }, {} as InternalSocialDataList);\n}\n"],"sourceRoot":""}