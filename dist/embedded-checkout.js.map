{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///external \"tslib\"","webpack:///./src/embedded-checkout/iframe-content/embedded-content-events.ts","webpack:///external \"iframe-resizer\"","webpack:///external \"iframe-resizer/js/iframeResizer.contentWindow\"","webpack:///./src/common/iframe/iframe-event-poster.ts","webpack:///./src/common/iframe/iframe-event-listener.ts","webpack:///./src/embedded-checkout/errors/not-embeddable-error.ts","webpack:///./src/common/storage/browser-storage.ts","webpack:///./src/embedded-checkout/errors/invalid-login-token-error.ts","webpack:///./src/embedded-checkout/embedded-checkout.ts","webpack:///./src/embedded-checkout/loading-indicator.ts","webpack:///./src/embedded-checkout/resizable-iframe-creator.ts","webpack:///./src/embedded-checkout/embed-checkout.ts","webpack:///./src/embedded-checkout/iframe-content/handle-frame-loaded-event.ts","webpack:///./src/common/error/errors/custom-error.ts","webpack:///./src/embedded-checkout/iframe-content/iframe-embedded-checkout-messenger.ts","webpack:///./src/embedded-checkout/iframe-content/noop-embedded-checkout-messenger.ts","webpack:///./src/embedded-checkout/iframe-content/create-embedded-checkout-messenger.ts","webpack:///./src/common/iframe/iframe-resizer.ts","webpack:///./src/bundles/embedded-checkout.ts","webpack:///./src/common/error/errors/standard-error.ts","webpack:///./src/common/utility/set-prototype-of.ts","webpack:///./src/embedded-checkout/embedded-checkout-events.ts","webpack:///external \"rxjs\"","webpack:///./src/common/error/errors/request-error.ts","webpack:///external \"@bigcommerce/request-sender\"","webpack:///./src/common/error/errors/invalid-argument-error.ts","webpack:///./src/common/iframe/is-iframe-event.ts","webpack:///external \"local-storage-fallback\"","webpack:///external \"rxjs/operators\"","webpack:///./src/common/url/parse-url.ts","webpack:///./src/common/utility/bind-decorator.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","require","EmbeddedContentEventType","targetOrigin","_targetWindow","this","_targetOrigin","origin","post","event","options","window","Error","result","pipe","data","type","successType","errorType","indexOf","toPromise","postMessage","setTarget","sourceOrigin","_sourceOrigin","_isListening","_listeners","listen","addEventListener","_handleMessage","stopListen","removeEventListener","addListener","listener","listeners","push","removeListener","index","splice","trigger","forEach","NotEmbeddableErrorType","_namespace","getItem","rawValue","withNamespace","JSON","parse","error","removeItem","getItemOnce","setItem","stringify","response","message","body","title","subtype","UnknownError","_iframeCreator","_messageListener","_messagePoster","_loadingIndicator","_requestSender","_storage","_location","_options","_isAttached","onComplete","CheckoutComplete","onError","CheckoutError","onLoad","CheckoutLoaded","onFrameLoad","FrameLoaded","onSignOut","SignedOut","_configureStyles","attach","Promise","resolve","show","containerId","_allowCookie","then","_attemptLogin","url","createFrame","iframe","_iframe","hide","catch","_retryAllowCookie","FrameError","payload","detach","parentNode","removeChild","iFrameResizer","close","contentWindow","styles","StyleConfigured","test","pathname","reject","Date","now","redirectUrl","encodeURIComponent","href","document","style","visibility","replace","lastAttempt","Number","MissingContent","EmbeddedCheckout","DEFAULT_STYLES","size","color","backgroundColor","ROTATION_ANIMATION","_styles","_defineAnimation","_container","_buildContainer","_indicator","_buildIndicator","appendChild","parentId","getElementById","opacity","handleTransitionEnd","container","createElement","display","bottom","left","height","width","position","right","top","transition","indicator","borderRadius","border","borderColor","margin","transform","transformStyle","animation","id","head","sheet","CSSStyleSheet","insertRule","src","timeout","MissingContainer","allowPaymentRequest","_toResizableFrame","timeoutInterval","setTimeout","handleMessage","teardown","contentId","iframes","scrolling","sizeWidth","heightCalculationMethod","length","clearTimeout","STORAGE_PREFIX","embedCheckout","loadingIndicator","location","handleFrameLoadedEvent","hasAttribute","setAttribute","isCustomError","_untargetedMessagePoster","_messageHandlers","postComplete","_postMessage","postError","_transformError","postFrameError","untargeted","postFrameLoaded","postLoaded","postSignedOut","receiveStyles","handler","_notifyMessageHandlers","keys","undefined","IframeEmbeddedCheckoutMessenger","NoopEmbeddedCheckoutMessenger","createEmbeddedCheckoutMessenger","parentWindow","parent","parentOrigin","iframeResizer","target","originalIframeResizer","setupContentWindowForIframeResizer","setPrototypeOf","__proto__","captureStackTrace","stack","EmbeddedCheckoutEventType","DEFAULT_RESPONSE","headers","status","errors","isIframeEvent","parseUrl","anchor","port","hostname","hash","protocol","search","bindMethodDecorator","_","descriptor","method","boundMethod","set","decoratedTarget","getOwnPropertyNames","getOwnPropertyDescriptor","bindClassDecorator"],"mappings":"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","file":"embedded-checkout.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 192);\n","module.exports = require(\"tslib\");","import EmbeddedCheckoutStyles from '../embedded-checkout-styles';\n\nexport enum EmbeddedContentEventType {\n    StyleConfigured = 'STYLE_CONFIGURED',\n}\n\nexport interface EmbeddedContentEventMap {\n    [EmbeddedContentEventType.StyleConfigured]: EmbeddedContentStyleConfiguredEvent;\n}\n\nexport type EmbeddedContentEvent = (\n    EmbeddedContentStyleConfiguredEvent\n);\n\nexport interface EmbeddedContentStyleConfiguredEvent {\n    type: EmbeddedContentEventType.StyleConfigured;\n    payload: EmbeddedCheckoutStyles;\n}\n","module.exports = require(\"iframe-resizer\");","module.exports = require(\"iframe-resizer/js/iframeResizer.contentWindow\");","import { fromEvent } from 'rxjs';\nimport { filter, map, take } from 'rxjs/operators';\n\nimport { parseUrl } from '../url';\n\nimport IframeEvent from './iframe-event';\nimport isIframeEvent from './is-iframe-event';\n\nexport interface IframeEventPostOptions<TSuccessEvent extends IframeEvent, TErrorEvent extends IframeEvent> {\n    errorType?: TErrorEvent['type'];\n    successType?: TSuccessEvent['type'];\n}\n\nexport default class IframeEventPoster<TEvent> {\n    private _targetOrigin: string;\n\n    constructor(\n        targetOrigin: string,\n        private _targetWindow?: Window\n    ) {\n        this._targetOrigin = targetOrigin === '*' ? '*' : parseUrl(targetOrigin).origin;\n    }\n\n    post(event: TEvent): void;\n    post<TSuccessEvent extends IframeEvent = IframeEvent, TErrorEvent extends IframeEvent = IframeEvent>(\n        event: TEvent,\n        options: IframeEventPostOptions<TSuccessEvent, TErrorEvent>\n    ): Promise<TSuccessEvent>;\n    post<TSuccessEvent extends IframeEvent = IframeEvent, TErrorEvent extends IframeEvent = IframeEvent>(\n        event: TEvent,\n        options?: IframeEventPostOptions<TSuccessEvent, TErrorEvent>\n    ): Promise<TSuccessEvent> | void {\n        if (window === this._targetWindow) {\n            return;\n        }\n\n        if (!this._targetWindow) {\n            throw new Error('Unable to post message because target window is not set.');\n        }\n\n        const result = options && fromEvent<MessageEvent>(window, 'message')\n            .pipe(\n                filter(event =>\n                    event.origin === this._targetOrigin &&\n                    isIframeEvent(event.data, event.data.type) &&\n                    [options.successType, options.errorType].indexOf(event.data.type) !== -1\n                ),\n                map(event => {\n                    if (options.errorType === event.data.type) {\n                        throw event.data;\n                    }\n\n                    return event.data;\n                }),\n                take(1)\n            )\n            .toPromise();\n\n        this._targetWindow.postMessage(event, this._targetOrigin);\n\n        return result;\n    }\n\n    setTarget(window: Window) {\n        this._targetWindow = window;\n    }\n}\n","import { parseUrl } from '../url';\nimport { bindDecorator as bind } from '../utility';\n\nimport { IframeEventMap } from './iframe-event';\nimport isIframeEvent from './is-iframe-event';\n\nexport default class IframeEventListener<TEventMap extends IframeEventMap<keyof TEventMap>> {\n    private _isListening: boolean;\n    private _listeners: EventListeners<TEventMap>;\n    private _sourceOrigin: string;\n\n    constructor(\n        sourceOrigin: string\n    ) {\n        this._sourceOrigin = parseUrl(sourceOrigin).origin;\n        this._isListening = false;\n        this._listeners = {};\n    }\n\n    listen(): void {\n        if (this._isListening) {\n            return;\n        }\n\n        this._isListening = true;\n\n        window.addEventListener('message', this._handleMessage);\n    }\n\n    stopListen(): void {\n        if (!this._isListening) {\n            return;\n        }\n\n        this._isListening = false;\n\n        window.removeEventListener('message', this._handleMessage);\n    }\n\n    addListener<TType extends keyof TEventMap>(type: TType, listener: (event: TEventMap[TType]) => void): void {\n        let listeners = this._listeners[type];\n\n        if (!listeners) {\n            this._listeners[type] = listeners = [];\n        }\n\n        if (listeners.indexOf(listener) === -1) {\n            listeners.push(listener);\n        }\n    }\n\n    removeListener<TType extends keyof TEventMap>(type: TType, listener: (event: TEventMap[TType]) => void): void {\n        const listeners = this._listeners[type];\n\n        if (!listeners) {\n            return;\n        }\n\n        const index = listeners.indexOf(listener);\n\n        if (index >= 0) {\n            listeners.splice(index, 1);\n        }\n    }\n\n    trigger<TType extends keyof TEventMap>(event: TEventMap[TType]): void {\n        const listeners = this._listeners[event.type];\n\n        if (!listeners) {\n            return;\n        }\n\n        listeners.forEach(listener => listener(event));\n    }\n\n    @bind\n    private _handleMessage(event: MessageEvent): void {\n        if ((event.origin !== this._sourceOrigin) ||\n            !isIframeEvent(event.data as TEventMap[keyof TEventMap], event.data.type)\n        ) {\n            return;\n        }\n\n        this.trigger(event.data);\n    }\n}\n\ntype EventListeners<TEventMap> = {\n    [key in keyof TEventMap]?: Array<(event: TEventMap[key]) => void>;\n};\n","import { StandardError } from '../../common/error/errors';\n\nexport enum NotEmbeddableErrorType {\n    MissingContainer = 'missing_container',\n    MissingContent = 'missing_content',\n    UnknownError = 'unknown_error',\n}\n\n/**\n * Throw this error if we are not able to embed the checkout form as an iframe.\n * This can be due to the fact that the provided container ID is invalid, or the\n * checkout form fails to load inside the iframe. It can also be due to an\n * unknown reason.\n */\nexport default class NotEmbeddableError extends StandardError {\n    constructor(\n        message?: string,\n        public subtype: NotEmbeddableErrorType = NotEmbeddableErrorType.UnknownError\n    ) {\n        super(message || 'Unable to embed the checkout form.');\n\n        this.name = 'NotEmbeddableError';\n        this.type = 'not_embeddable';\n    }\n}\n","import { default as storage } from 'local-storage-fallback';\n\nexport default class BrowserStorage {\n    constructor(\n        private _namespace: string\n    ) {}\n\n    getItem<TValue = any>(key: string): TValue | null {\n        const rawValue = storage.getItem(this.withNamespace(key));\n\n        if (rawValue === null) {\n            return null;\n        }\n\n        try {\n            return JSON.parse(rawValue);\n        } catch (error) {\n            // Clean up invalid values\n            this.removeItem(this.withNamespace(key));\n\n            return null;\n        }\n    }\n\n    getItemOnce<TValue = any>(key: string): TValue | null {\n        const value = this.getItem(key);\n\n        this.removeItem(key);\n\n        return value;\n    }\n\n    setItem<TValue = any>(key: string, value: TValue): void {\n        return storage.setItem(this.withNamespace(key), JSON.stringify(value));\n    }\n\n    removeItem(key: string): void {\n        return storage.removeItem(this.withNamespace(key));\n    }\n\n    private withNamespace(key: string): string {\n        return `${this._namespace}.${key}`;\n    }\n}\n","import { Response } from '@bigcommerce/request-sender';\n\nimport { InternalErrorResponseBody } from '../../common/error';\nimport { RequestError } from '../../common/error/errors';\n\n/**\n * Throw this error we are not able to sign in a shopper because the provided\n * login token is invalid.\n */\nexport default class InvalidLoginTokenError extends RequestError {\n    constructor(response: Response<InternalErrorResponseBody>) {\n        super(response, { message: response.body.title });\n\n        this.name = 'InvalidLoginTokenError';\n        this.type = 'invalid_login_token';\n    }\n}\n","import { RequestSender } from '@bigcommerce/request-sender';\n\nimport { IframeEventListener, IframeEventPoster, IFrameComponent } from '../common/iframe';\nimport { BrowserStorage } from '../common/storage';\nimport { parseUrl } from '../common/url';\nimport { bindDecorator as bind } from '../common/utility';\n\nimport EmbeddedCheckoutError from './embedded-checkout-error';\nimport { EmbeddedCheckoutEventMap, EmbeddedCheckoutEventType } from './embedded-checkout-events';\nimport EmbeddedCheckoutOptions from './embedded-checkout-options';\nimport { InvalidLoginTokenError, NotEmbeddableError, NotEmbeddableErrorType } from './errors';\nimport { EmbeddedContentEvent, EmbeddedContentEventType } from './iframe-content';\nimport LoadingIndicator from './loading-indicator';\nimport ResizableIframeCreator from './resizable-iframe-creator';\n\nexport const ALLOW_COOKIE_ATTEMPT_INTERVAL = 10 * 60 * 1000;\nexport const IS_COOKIE_ALLOWED_KEY = 'isCookieAllowed';\nexport const LAST_ALLOW_COOKIE_ATTEMPT_KEY = 'lastAllowCookieAttempt';\n\n@bind\nexport default class EmbeddedCheckout {\n    private _iframe?: IFrameComponent;\n    private _isAttached: boolean;\n\n    /**\n     * @internal\n     */\n    constructor(\n        private _iframeCreator: ResizableIframeCreator,\n        private _messageListener: IframeEventListener<EmbeddedCheckoutEventMap>,\n        private _messagePoster: IframeEventPoster<EmbeddedContentEvent>,\n        private _loadingIndicator: LoadingIndicator,\n        private _requestSender: RequestSender,\n        private _storage: BrowserStorage,\n        private _location: Location,\n        private _options: EmbeddedCheckoutOptions\n    ) {\n        this._isAttached = false;\n\n        if (this._options.onComplete) {\n            this._messageListener.addListener(EmbeddedCheckoutEventType.CheckoutComplete, this._options.onComplete);\n        }\n\n        if (this._options.onError) {\n            this._messageListener.addListener(EmbeddedCheckoutEventType.CheckoutError, this._options.onError);\n        }\n\n        if (this._options.onLoad) {\n            this._messageListener.addListener(EmbeddedCheckoutEventType.CheckoutLoaded, this._options.onLoad);\n        }\n\n        if (this._options.onFrameLoad) {\n            this._messageListener.addListener(EmbeddedCheckoutEventType.FrameLoaded, this._options.onFrameLoad);\n        }\n\n        if (this._options.onSignOut) {\n            this._messageListener.addListener(EmbeddedCheckoutEventType.SignedOut, this._options.onSignOut);\n        }\n\n        this._messageListener.addListener(EmbeddedCheckoutEventType.FrameLoaded, () => this._configureStyles());\n    }\n\n    attach(): Promise<this> {\n        if (this._isAttached) {\n            return Promise.resolve(this);\n        }\n\n        this._isAttached = true;\n        this._messageListener.listen();\n        this._loadingIndicator.show(this._options.containerId);\n\n        return this._allowCookie()\n            .then(() => this._attemptLogin())\n            .then(url => this._iframeCreator.createFrame(url, this._options.containerId))\n            .then(iframe => {\n                this._iframe = iframe;\n\n                this._configureStyles();\n                this._loadingIndicator.hide();\n            })\n            .catch(error => {\n                this._isAttached = false;\n\n                return this._retryAllowCookie(error)\n                    .catch(() => {\n                        this._messageListener.trigger({\n                            type: EmbeddedCheckoutEventType.FrameError,\n                            payload: error,\n                        });\n\n                        this._loadingIndicator.hide();\n\n                        throw error;\n                    });\n            })\n            .then(() => this);\n    }\n\n    detach(): void {\n        if (!this._isAttached) {\n            return;\n        }\n\n        this._isAttached = false;\n        this._messageListener.stopListen();\n\n        if (this._iframe && this._iframe.parentNode) {\n            this._iframe.parentNode.removeChild(this._iframe);\n            this._iframe.iFrameResizer.close();\n        }\n    }\n\n    private _configureStyles(): void {\n        if (!this._iframe || !this._iframe.contentWindow || !this._options.styles) {\n            return;\n        }\n\n        this._messagePoster.setTarget(this._iframe.contentWindow);\n\n        this._messagePoster.post({\n            type: EmbeddedContentEventType.StyleConfigured,\n            payload: this._options.styles,\n        });\n    }\n\n    private _attemptLogin(): Promise<string> {\n        if (!/^\\/login\\/token/.test(parseUrl(this._options.url).pathname)) {\n            return Promise.resolve(this._options.url);\n        }\n\n        return this._requestSender.post<{ redirectUrl: string }>(this._options.url)\n            .then(({ body: { redirectUrl } }) => redirectUrl)\n            .catch(response => Promise.reject(new InvalidLoginTokenError(response)));\n    }\n\n    /**\n     * This workaround is required for certain browsers (namely Safari) that\n     * prevent session cookies to be set for a third party website unless the\n     * user has recently visited such website. Therefore, before we attempt to\n     * login or set an active cart in the session, we need to first redirect the\n     * user to the domain of Embedded Checkout.\n     */\n    private _allowCookie(): Promise<void> {\n        if (this._storage.getItem(IS_COOKIE_ALLOWED_KEY)) {\n            return Promise.resolve();\n        }\n\n        this._storage.setItem(IS_COOKIE_ALLOWED_KEY, true);\n\n        // It could be possible that the flag is set to true but the browser has\n        // already removed the permission to store third-party cookies. In that\n        // case, we should try to redirect the user again. But we only want to\n        // do it once within a fixed interval. This is to avoid getting into a\n        // redirect loop if the shopper actually doesn't have a valid card\n        // session.\n        this._storage.setItem(LAST_ALLOW_COOKIE_ATTEMPT_KEY, Date.now());\n\n        const { origin } = parseUrl(this._options.url);\n        const redirectUrl = `${origin}/embedded-checkout/allow-cookie?returnUrl=${encodeURIComponent(this._location.href)}`;\n\n        document.body.style.visibility = 'hidden';\n        this._location.replace(redirectUrl);\n\n        return new Promise<never>(() => {});\n    }\n\n    private _retryAllowCookie(error: EmbeddedCheckoutError): Promise<void> {\n        const lastAttempt = Number(this._storage.getItem(LAST_ALLOW_COOKIE_ATTEMPT_KEY));\n        const canRetry = (\n            (!lastAttempt || Date.now() - lastAttempt > ALLOW_COOKIE_ATTEMPT_INTERVAL) &&\n            error instanceof NotEmbeddableError &&\n            error.subtype === NotEmbeddableErrorType.MissingContent\n        );\n\n        if (!canRetry) {\n            return Promise.reject();\n        }\n\n        this._storage.removeItem(LAST_ALLOW_COOKIE_ATTEMPT_KEY);\n        this._storage.removeItem(IS_COOKIE_ALLOWED_KEY);\n\n        return this._allowCookie();\n    }\n}\n","import { LoadingIndicatorStyles } from './embedded-checkout-styles';\n\nconst DEFAULT_STYLES: LoadingIndicatorStyles = {\n    size: 70,\n    color: '#d9d9d9',\n    backgroundColor: '#ffffff',\n};\n\nconst ROTATION_ANIMATION = 'embedded-checkout-loading-indicator-rotation';\n\nexport default class LoadingIndicator {\n    private _container: HTMLElement;\n    private _indicator: HTMLElement;\n    private _styles: LoadingIndicatorStyles;\n\n    constructor(\n        options?: { styles?: LoadingIndicatorStyles }\n    ) {\n        this._styles = { ...DEFAULT_STYLES, ...options && options.styles };\n\n        this._defineAnimation();\n\n        this._container = this._buildContainer();\n        this._indicator = this._buildIndicator();\n\n        this._container.appendChild(this._indicator);\n    }\n\n    show(parentId?: string): void {\n        if (parentId) {\n            const parent = document.getElementById(parentId);\n\n            if (!parent) {\n                throw new Error('Unable to attach the loading indicator because the parent ID is not valid.');\n            }\n\n            parent.appendChild(this._container);\n        }\n\n        this._container.style.visibility = 'visible';\n        this._container.style.opacity = '1';\n    }\n\n    hide(): void {\n        const handleTransitionEnd = () => {\n            this._container.style.visibility = 'hidden';\n\n            this._container.removeEventListener('transitionend', handleTransitionEnd);\n        };\n\n        this._container.addEventListener('transitionend', handleTransitionEnd);\n\n        this._container.style.opacity = '0';\n    }\n\n    private _buildContainer(): HTMLElement {\n        const container = document.createElement('div');\n\n        container.style.display = 'block';\n        container.style.bottom = '0';\n        container.style.left = '0';\n        container.style.height = '100%';\n        container.style.width = '100%';\n        container.style.position = 'absolute';\n        container.style.right = '0';\n        container.style.top = '0';\n        container.style.transition = 'all 250ms ease-out';\n        container.style.opacity = '0';\n\n        return container;\n    }\n\n    private _buildIndicator(): HTMLElement {\n        const indicator = document.createElement('div');\n\n        indicator.style.display = 'block';\n        indicator.style.width = `${this._styles.size}px`;\n        indicator.style.height = `${this._styles.size}px`;\n        indicator.style.borderRadius = `${this._styles.size}px`;\n        indicator.style.border = 'solid 1px';\n        indicator.style.borderColor = `${this._styles.backgroundColor} ${this._styles.backgroundColor} ${this._styles.color} ${this._styles.color}`;\n        indicator.style.margin = '0 auto';\n        indicator.style.position = 'absolute';\n        indicator.style.left = '0';\n        indicator.style.right = '0';\n        indicator.style.top = '50%';\n        indicator.style.transform = 'translateY(-50%) rotate(0deg)';\n        indicator.style.transformStyle = 'preserve-3d';\n        indicator.style.animation = `${ROTATION_ANIMATION} 500ms infinite cubic-bezier(0.69, 0.31, 0.56, 0.83)`;\n\n        return indicator;\n    }\n\n    private _defineAnimation(): void {\n        // In order to define CSS animation, we need to insert a stylesheet into the host frame.\n        // We only have to do it once.\n        if (document.getElementById(ROTATION_ANIMATION)) {\n            return;\n        }\n\n        const style = document.createElement('style');\n\n        style.id = ROTATION_ANIMATION;\n\n        document.head.appendChild(style);\n\n        if (style.sheet instanceof CSSStyleSheet) {\n            // We need to provide the 2nd parameter for IE11, even though it is\n            // 0 by default for all other browsers.\n            style.sheet.insertRule(`\n                @keyframes ${ROTATION_ANIMATION} {\n                    0% { transform: translateY(-50%) rotate(0deg); }\n                    100% { transform: translateY(-50%) rotate(360deg); }\n                }\n            `, 0);\n        }\n    }\n}\n","import { iframeResizer, isIframeEvent, IFrameComponent } from '../common/iframe';\nimport { parseUrl } from '../common/url';\n\nimport { EmbeddedCheckoutEventType } from './embedded-checkout-events';\nimport { NotEmbeddableError, NotEmbeddableErrorType } from './errors';\n\nexport default class ResizableIframeCreator {\n    constructor(\n        private _options?: { timeout: number }\n    ) {}\n\n    createFrame(src: string, containerId: string): Promise<IFrameComponent> {\n        const container = document.getElementById(containerId);\n        const { timeout = 60000 } = this._options || {};\n\n        if (!container) {\n            throw new NotEmbeddableError(\n                'Unable to embed the iframe because the container element could not be found.',\n                NotEmbeddableErrorType.MissingContainer\n            );\n        }\n\n        const iframe = document.createElement('iframe');\n\n        iframe.src = src;\n        iframe.style.border = 'none';\n        iframe.style.display = 'none';\n        iframe.style.width = '100%';\n        iframe.allowPaymentRequest = true;\n\n        container.appendChild(iframe);\n\n        return this._toResizableFrame(iframe, timeout)\n            .catch(error => {\n                container.removeChild(iframe);\n\n                throw error;\n            });\n    }\n\n    private _toResizableFrame(iframe: HTMLIFrameElement, timeoutInterval: number): Promise<IFrameComponent> {\n        // Can't simply listen to `load` event because it always gets triggered even if there's an error.\n        // Instead, listen to the `load` inside the iframe and let the parent frame know when it happens.\n        return new Promise((resolve, reject) => {\n            const timeout = window.setTimeout(() => {\n                reject(new NotEmbeddableError('Unable to embed the iframe because the content could not be loaded.'));\n            }, timeoutInterval);\n\n            const handleMessage = (event: MessageEvent) => {\n                if (event.origin !== parseUrl(iframe.src).origin) {\n                    return;\n                }\n\n                if (isIframeEvent(event.data, EmbeddedCheckoutEventType.FrameError)) {\n                    teardown();\n                    reject(new NotEmbeddableError(event.data.payload.message, NotEmbeddableErrorType.MissingContent));\n                }\n\n                if (isIframeEvent(event.data, EmbeddedCheckoutEventType.FrameLoaded)) {\n                    iframe.style.display = '';\n\n                    const contentId = event.data.payload && event.data.payload.contentId;\n                    const iframes = iframeResizer({\n                        scrolling: false,\n                        sizeWidth: false,\n                        heightCalculationMethod: contentId ? 'taggedElement' : 'lowestElement',\n                    }, iframe);\n\n                    teardown();\n                    resolve(iframes[iframes.length - 1]);\n                }\n            };\n\n            const teardown = () => {\n                window.removeEventListener('message', handleMessage);\n                window.clearTimeout(timeout);\n            };\n\n            window.addEventListener('message', handleMessage);\n        });\n    }\n}\n","import { createRequestSender } from '@bigcommerce/request-sender';\n\nimport { IframeEventListener, IframeEventPoster } from '../common/iframe';\nimport { BrowserStorage } from '../common/storage';\nimport { parseUrl } from '../common/url';\n\nimport EmbeddedCheckout from './embedded-checkout';\nimport { EmbeddedCheckoutEventMap } from './embedded-checkout-events';\nimport EmbeddedCheckoutOptions from './embedded-checkout-options';\nimport { EmbeddedContentEvent } from './iframe-content';\nimport LoadingIndicator from './loading-indicator';\nimport ResizableIframeCreator from './resizable-iframe-creator';\n\nconst STORAGE_PREFIX = 'BigCommerce.EmbeddedCheckout';\n\n/**\n * Embed the checkout form in an iframe.\n *\n * @remarks\n * Once the iframe is embedded, it will automatically resize according to the\n * size of the checkout form. It will also notify the parent window when certain\n * events have occurred. i.e.: when the form is loaded and ready to be used.\n *\n * ```js\n * embedCheckout({\n *     url: 'https://checkout/url',\n *     containerId: 'container-id',\n * });\n * ```\n *\n * @param options - Options for embedding the checkout form.\n * @returns A promise that resolves to an instance of `EmbeddedCheckout`.\n */\nexport default function embedCheckout(options: EmbeddedCheckoutOptions): Promise<EmbeddedCheckout> {\n    const origin = parseUrl(options.url).origin;\n    const embeddedCheckout = new EmbeddedCheckout(\n        new ResizableIframeCreator(),\n        new IframeEventListener<EmbeddedCheckoutEventMap>(origin),\n        new IframeEventPoster<EmbeddedContentEvent>(origin),\n        new LoadingIndicator({ styles: options.styles && options.styles.loadingIndicator }),\n        createRequestSender(),\n        new BrowserStorage(STORAGE_PREFIX),\n        window.location,\n        options\n    );\n\n    return embeddedCheckout.attach();\n}\n","import { EmbeddedCheckoutFrameLoadedEvent } from '../embedded-checkout-events';\n\nexport default function handleFrameLoadedEvent(message: EmbeddedCheckoutFrameLoadedEvent): void {\n    if (!message.payload || !message.payload.contentId) {\n        return;\n    }\n\n    const body = document.getElementById(message.payload.contentId);\n\n    if (!body || body.hasAttribute('data-iframe-height')) {\n        return;\n    }\n\n    body.setAttribute('data-iframe-height', '');\n}\n","export default interface CustomError extends Error {\n    message: string;\n    type: string;\n    subtype?: string;\n}\n\nexport function isCustomError(error: any): error is CustomError {\n    return (\n        typeof error.message === 'string' &&\n        typeof error.type === 'string' &&\n        (typeof error.subtype === 'string' || !error.subtype) &&\n        error instanceof Error\n    );\n}\n","import { isCustomError, CustomError } from '../../common/error/errors';\nimport { IframeEventListener, IframeEventPoster } from '../../common/iframe';\nimport { bindDecorator as bind } from '../../common/utility';\nimport EmbeddedCheckoutError from '../embedded-checkout-error';\nimport { EmbeddedCheckoutCompleteEvent, EmbeddedCheckoutErrorEvent, EmbeddedCheckoutEvent, EmbeddedCheckoutEventMap, EmbeddedCheckoutEventType, EmbeddedCheckoutFrameErrorEvent, EmbeddedCheckoutFrameLoadedEvent, EmbeddedCheckoutLoadedEvent, EmbeddedCheckoutSignedOutEvent } from '../embedded-checkout-events';\nimport EmbeddedCheckoutStyles from '../embedded-checkout-styles';\n\nimport EmbeddedCheckoutMessenger from './embedded-checkout-messenger';\nimport { EmbeddedContentEventMap, EmbeddedContentEventType } from './embedded-content-events';\nimport EmbeddedContentOptions from './embedded-content-options';\n\n@bind\nexport default class IframeEmbeddedCheckoutMessenger implements EmbeddedCheckoutMessenger {\n    /**\n     * @internal\n     */\n    constructor(\n        private _messageListener: IframeEventListener<EmbeddedContentEventMap>,\n        private _messagePoster: IframeEventPoster<EmbeddedCheckoutEvent>,\n        private _untargetedMessagePoster: IframeEventPoster<EmbeddedCheckoutEvent>,\n        private _messageHandlers: EventCallbacks<EmbeddedCheckoutEventMap> = {}\n    ) {\n        this._messageListener.listen();\n    }\n\n    postComplete(): void {\n        const message: EmbeddedCheckoutCompleteEvent = {\n            type: EmbeddedCheckoutEventType.CheckoutComplete,\n        };\n\n        this._postMessage(message);\n    }\n\n    postError(payload: Error | CustomError): void {\n        const message: EmbeddedCheckoutErrorEvent = {\n            type: EmbeddedCheckoutEventType.CheckoutError,\n            payload: this._transformError(payload),\n        };\n\n        this._postMessage(message);\n    }\n\n    postFrameError(payload: Error | CustomError): void {\n        const message: EmbeddedCheckoutFrameErrorEvent = {\n            type: EmbeddedCheckoutEventType.FrameError,\n            payload: this._transformError(payload),\n        };\n\n        // Ideally, all messages should be targeted at a specific origin.\n        // However, for `FrameError` message, we have to post it in an\n        // untargeted fashion. This is because the error could be caused by a\n        // missing cart. That makes it not possible to determine of site origin\n        // of the parent window. Nevertheless, we still want to notify the\n        // parent window about the error.\n        this._postMessage(message, { untargeted: true });\n    }\n\n    postFrameLoaded(payload?: EmbeddedContentOptions): void {\n        const message: EmbeddedCheckoutFrameLoadedEvent = {\n            type: EmbeddedCheckoutEventType.FrameLoaded,\n            payload,\n        };\n\n        this._postMessage(message);\n    }\n\n    postLoaded(): void {\n        const message: EmbeddedCheckoutLoadedEvent = {\n            type: EmbeddedCheckoutEventType.CheckoutLoaded,\n        };\n\n        this._postMessage(message);\n    }\n\n    postSignedOut(): void {\n        const message: EmbeddedCheckoutSignedOutEvent = {\n            type: EmbeddedCheckoutEventType.SignedOut,\n        };\n\n        this._postMessage(message);\n    }\n\n    receiveStyles(handler: (styles: EmbeddedCheckoutStyles) => void): void {\n        this._messageListener.addListener(EmbeddedContentEventType.StyleConfigured, ({ payload }) => {\n            handler(payload);\n        });\n    }\n\n    private _postMessage(message: EmbeddedCheckoutEvent, options?: { untargeted?: boolean }): void {\n        this._notifyMessageHandlers(message);\n\n        if (options && options.untargeted) {\n            return this._untargetedMessagePoster.post(message);\n        }\n\n        this._messagePoster.post(message);\n    }\n\n    private _notifyMessageHandlers(message: EmbeddedCheckoutEvent): void {\n        Object.keys(this._messageHandlers)\n            .forEach(key => {\n                if (message.type !== key) {\n                    return;\n                }\n\n                const handler = this._messageHandlers[key];\n\n                if (handler) {\n                    (handler as (event: EmbeddedCheckoutEvent) => void).call(null, message);\n                }\n            });\n    }\n\n    private _transformError(error: Error | CustomError): EmbeddedCheckoutError {\n        return {\n            message: error.message,\n            type: isCustomError(error) ? error.type : undefined,\n            subtype: isCustomError(error) ? error.subtype : undefined,\n        };\n    }\n}\n\nexport type EventCallbacks<TEventMap> = {\n    [key in keyof TEventMap]?: (event: TEventMap[key]) => void;\n};\n","import { bindDecorator as bind } from '../../common/utility';\n\nimport EmbeddedCheckoutMessenger from './embedded-checkout-messenger';\n\n@bind\nexport default class NoopEmbeddedCheckoutMessenger implements EmbeddedCheckoutMessenger {\n    postComplete(): void {}\n\n    postError(): void {}\n\n    postFrameError(): void {}\n\n    postFrameLoaded(): void {}\n\n    postLoaded(): void {}\n\n    postSignedOut(): void {}\n\n    receiveStyles(): void {}\n}\n","import { setupContentWindowForIframeResizer, IframeEventListener, IframeEventPoster } from '../../common/iframe';\nimport { EmbeddedCheckoutEvent, EmbeddedCheckoutEventType } from '../embedded-checkout-events';\n\nimport EmbeddedCheckoutMessenger from './embedded-checkout-messenger';\nimport EmbeddedCheckoutMessengerOptions from './embedded-checkout-messenger-options';\nimport { EmbeddedContentEventMap } from './embedded-content-events';\nimport handleFrameLoadedEvent from './handle-frame-loaded-event';\nimport IframeEmbeddedCheckoutMessenger from './iframe-embedded-checkout-messenger';\nimport NoopEmbeddedCheckoutMessenger from './noop-embedded-checkout-messenger';\n\n/**\n * Create an instance of `EmbeddedCheckoutMessenger`.\n *\n * @remarks\n * The object is responsible for posting messages to the parent window from the\n * iframe when certain events have occurred. For example, when the checkout\n * form is first loaded, you should notify the parent window about it.\n *\n * The iframe can only be embedded in domains that are allowed by the store.\n *\n * ```ts\n * const messenger = createEmbeddedCheckoutMessenger({\n *     parentOrigin: 'https://some/website',\n * });\n *\n * messenger.postFrameLoaded();\n * ```\n *\n * @alpha\n * Please note that this feature is currently in an early stage of development.\n * Therefore the API is unstable and not ready for public consumption.\n *\n * @param options - Options for creating `EmbeddedCheckoutMessenger`\n * @returns - An instance of `EmbeddedCheckoutMessenger`\n */\nexport default function createEmbeddedCheckoutMessenger(options: EmbeddedCheckoutMessengerOptions): EmbeddedCheckoutMessenger {\n    setupContentWindowForIframeResizer();\n\n    const parentWindow = options.parentWindow || window.parent;\n\n    // Return a No-op messenger if it is not called inside an iframe\n    if (window === parentWindow) {\n        return new NoopEmbeddedCheckoutMessenger();\n    }\n\n    return new IframeEmbeddedCheckoutMessenger(\n        new IframeEventListener<EmbeddedContentEventMap>(options.parentOrigin),\n        new IframeEventPoster<EmbeddedCheckoutEvent>(options.parentOrigin, parentWindow),\n        new IframeEventPoster<EmbeddedCheckoutEvent>('*', parentWindow),\n        { [EmbeddedCheckoutEventType.FrameLoaded]: handleFrameLoadedEvent }\n    );\n}\n","import { IFrameComponent, IFrameOptions } from 'iframe-resizer';\n\nexport {\n    HeightCalculationMethod,\n    IFrameComponent,\n    IFrameMessageData,\n    IFrameObject,\n    IFrameOptions,\n    IFramePage,\n    IFramePageOptions,\n    IFrameResizedData,\n    IFrameScrollData,\n    PageInfo,\n    WidthCalculationMethod,\n} from 'iframe-resizer';\n\n// The reason why we are wrapping the original `iframeResizer` function imported\n// from the package is because the package sets up event listeners (window\n// resize etc...) as soon as the package is imported. Therefore, to defer the\n// side effect from happening until the function is actually being used, we are\n// importing the package inside this function. To minimise the chance of\n// importing the original package inadvertently, we are also re-exporting all of\n// its public interfaces. The re-exports do not cause any side effect because\n// they are plain TypeScript interfaces; meaning they are only used for type\n// checks rather than for code output.\nexport function iframeResizer(options: IFrameOptions, target: string | HTMLElement): IFrameComponent[] {\n    const { iframeResizer: originalIframeResizer } = require('iframe-resizer');\n\n    return originalIframeResizer(options, target);\n}\n\n// We also need to wrap the original `iframeResizer.contentWindow` because\n// similarly the package sets up event listeners as soon as the package gets\n// imported. Another reason is that if it is imported at the top level using a\n// regular import statement, it will be stripped out by Webpack as it is\n// considered as \"unused\", unless we explicitly mark it as a package that\n// produces side effects.\nexport function setupContentWindowForIframeResizer(): void {\n    /* eslint-disable-next-line import/no-internal-modules */\n    require('iframe-resizer/js/iframeResizer.contentWindow');\n}\n","export { embedCheckout } from '../embedded-checkout';\nexport { createEmbeddedCheckoutMessenger } from '../embedded-checkout/iframe-content';\n","import { setPrototypeOf } from '../../utility';\n\nimport CustomError from './custom-error';\n\n/**\n * This error type should not be constructed directly. It is a base class for\n * all custom errors thrown in this library.\n */\nexport default abstract class StandardError extends Error implements CustomError {\n    name = 'StandardError';\n    type = 'standard';\n\n    constructor(message?: string) {\n        super(message || 'An unexpected error has occurred.');\n\n        setPrototypeOf(this, new.target.prototype);\n\n        if (typeof Error.captureStackTrace === 'function') {\n            Error.captureStackTrace(this, new.target);\n        } else {\n            this.stack = (new Error(this.message)).stack;\n        }\n    }\n}\n","export default function setPrototypeOf(object: any, prototype: object) {\n    if (Object.setPrototypeOf) {\n        Object.setPrototypeOf(object, prototype);\n    } else {\n        object.__proto__ = prototype;\n    }\n\n    return object;\n}\n","import EmbeddedCheckoutError from './embedded-checkout-error';\nimport { EmbeddedContentOptions } from './iframe-content';\n\nexport enum EmbeddedCheckoutEventType {\n    CheckoutComplete = 'CHECKOUT_COMPLETE',\n    CheckoutError = 'CHECKOUT_ERROR',\n    CheckoutLoaded = 'CHECKOUT_LOADED',\n    FrameError = 'FRAME_ERROR',\n    FrameLoaded = 'FRAME_LOADED',\n    SignedOut = 'SIGNED_OUT',\n}\n\nexport interface EmbeddedCheckoutEventMap {\n    [EmbeddedCheckoutEventType.CheckoutComplete]: EmbeddedCheckoutCompleteEvent;\n    [EmbeddedCheckoutEventType.CheckoutError]: EmbeddedCheckoutErrorEvent;\n    [EmbeddedCheckoutEventType.CheckoutLoaded]: EmbeddedCheckoutLoadedEvent;\n    [EmbeddedCheckoutEventType.FrameError]: EmbeddedCheckoutFrameErrorEvent;\n    [EmbeddedCheckoutEventType.FrameLoaded]: EmbeddedCheckoutFrameLoadedEvent;\n    [EmbeddedCheckoutEventType.SignedOut]: EmbeddedCheckoutSignedOutEvent;\n}\n\nexport type EmbeddedCheckoutEvent = (\n    EmbeddedCheckoutCompleteEvent |\n    EmbeddedCheckoutErrorEvent |\n    EmbeddedCheckoutFrameErrorEvent |\n    EmbeddedCheckoutFrameLoadedEvent |\n    EmbeddedCheckoutLoadedEvent |\n    EmbeddedCheckoutSignedOutEvent\n);\n\nexport interface EmbeddedCheckoutCompleteEvent {\n    type: EmbeddedCheckoutEventType.CheckoutComplete;\n}\n\nexport interface EmbeddedCheckoutErrorEvent {\n    type: EmbeddedCheckoutEventType.CheckoutError;\n    payload: EmbeddedCheckoutError;\n}\n\nexport interface EmbeddedCheckoutLoadedEvent {\n    type: EmbeddedCheckoutEventType.CheckoutLoaded;\n}\n\nexport interface EmbeddedCheckoutFrameErrorEvent {\n    type: EmbeddedCheckoutEventType.FrameError;\n    payload: EmbeddedCheckoutError;\n}\n\nexport interface EmbeddedCheckoutFrameLoadedEvent {\n    type: EmbeddedCheckoutEventType.FrameLoaded;\n    payload?: EmbeddedContentOptions;\n}\n\nexport interface EmbeddedCheckoutSignedOutEvent {\n    type: EmbeddedCheckoutEventType.SignedOut;\n}\n","module.exports = require(\"rxjs\");","import { Response } from '@bigcommerce/request-sender';\n\nimport StandardError from './standard-error';\n\nconst DEFAULT_RESPONSE = {\n    body: {},\n    headers: {},\n    status: 0,\n};\n\n/**\n * Throw this error if we are unable to make a request to the server. It wraps\n * any server response into a JS error object.\n */\nexport default class RequestError<TBody = any> extends StandardError {\n    body: TBody | {};\n    headers: { [key: string]: any };\n    errors: Array<{ code: string; message?: string }>;\n    status: number;\n\n    constructor(\n        response?: Response<TBody | {}>,\n        { message, errors }: {\n            message?: string;\n            errors?: Array<{ code: string; message?: string }>;\n        } = {}\n    ) {\n        const { body, headers, status } = response || DEFAULT_RESPONSE;\n\n        super(message || 'An unexpected error has occurred.');\n\n        this.name = 'RequestError';\n        this.type = 'request';\n        this.body = body;\n        this.headers = headers;\n        this.status = status;\n        this.errors = errors || [];\n    }\n}\n","module.exports = require(\"@bigcommerce/request-sender\");","import StandardError from './standard-error';\n\n/**\n * This error should be thrown when a method is unable to proceed because the\n * caller has not provided all the arguments according to their requirements,\n * i.e.: if an argument is missing or it is not the expected data type.\n */\nexport default class InvalidArgumentError extends StandardError {\n    constructor(message?: string) {\n        super(message || 'Invalid arguments have been provided.');\n\n        this.name = 'InvalidArgumentError';\n        this.type = 'invalid_argument';\n    }\n}\n","import IframeEvent from './iframe-event';\n\nexport default function isIframeEvent<TEvent extends IframeEvent<TType>, TType extends string>(\n    object: any,\n    type: TType\n): object is TEvent {\n    return object.type === type;\n}\n","module.exports = require(\"local-storage-fallback\");","module.exports = require(\"rxjs/operators\");","import { InvalidArgumentError } from '../error/errors';\n\nimport Url from './url';\n\nexport default function parseUrl(url: string): Url {\n    if (!/^(https?:)?\\/\\//.test(url)) {\n        throw new InvalidArgumentError('The provided URL must be absolute.');\n    }\n\n    // new URL() is not supported in IE11, use anchor tag instead\n    const anchor = document.createElement('a');\n\n    anchor.href = url;\n\n    // IE11 returns 80 or 443 for the port number depending on the URL scheme,\n    // even if the port number is not specified in the URL.\n    const port = anchor.port && url.indexOf(`${anchor.hostname}:${anchor.port}`) !== -1 ?\n        anchor.port :\n        '';\n\n    return {\n        hash: anchor.hash,\n        hostname: anchor.hostname,\n        href: anchor.href,\n        origin: `${anchor.protocol}//${anchor.hostname}${port ? ':' + port : ''}`,\n        pathname: anchor.pathname,\n        port,\n        protocol: anchor.protocol,\n        search: anchor.search,\n    };\n}\n","/**\n * Decorates a class or a method by binding all its prototype methods or itself\n * to the calling instance respectively.\n */\nfunction bindDecorator<T extends Method>(target: object, key: string, descriptor: TypedPropertyDescriptor<T>): TypedPropertyDescriptor<T>;\nfunction bindDecorator<T extends Constructor<object>>(target: T): T;\nfunction bindDecorator(target: any, key?: any, descriptor?: any): any {\n    if (!key || !descriptor) {\n        return bindClassDecorator(target);\n    }\n\n    return bindMethodDecorator(target, key, descriptor);\n}\n\nexport default bindDecorator;\n\n/**\n * Decorates a class by binding all its prototype methods to the calling\n * instance.\n */\nexport function bindClassDecorator<T extends Constructor<object>>(target: T): T {\n    const decoratedTarget = class extends target {};\n\n    Object.getOwnPropertyNames(target.prototype)\n        .forEach(key => {\n            const descriptor = Object.getOwnPropertyDescriptor(target.prototype, key);\n\n            if (!descriptor || key === 'constructor') {\n                return;\n            }\n\n            Object.defineProperty(\n                decoratedTarget.prototype,\n                key,\n                bindMethodDecorator(target.prototype, key, descriptor)\n            );\n        });\n\n    return decoratedTarget;\n}\n\n/**\n * Decorates a method by binding it to the calling instance.\n */\nexport function bindMethodDecorator<T extends Method>(_: object, key: string, descriptor: TypedPropertyDescriptor<T>): TypedPropertyDescriptor<T> {\n    if (typeof descriptor.value !== 'function') {\n        return descriptor;\n    }\n\n    let method: T = descriptor.value;\n\n    return {\n        get() {\n            const boundMethod = method.bind(this) as T;\n\n            Object.defineProperty(this, key, {\n                ...descriptor,\n                value: boundMethod,\n            });\n\n            return boundMethod;\n        },\n        set(value) {\n            method = value;\n        },\n    };\n}\n\nexport type Constructor<T> = new (...args: any[]) => T;\nexport type Method = (...args: any[]) => any;\n"],"sourceRoot":""}